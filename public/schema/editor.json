{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "editor",
  "title": "Editor",
  "description": "Core rich text editor with basic formatting, text/link bubble menus, and toolbar components.",
  "dependencies": [
    "@tiptap/core",
    "@tiptap/react",
    "@tiptap/starter-kit",
    "@tiptap/extension-text-align",
    "@tiptap/extension-typography",
    "@tiptap/extension-underline",
    "@tiptap/extension-highlight",
    "@tiptap/extension-link",
    "@tiptap/extension-task-list",
    "@tiptap/extension-task-item",
    "@tiptap/extension-placeholder",
    "lucide-react"
  ],
  "registryDependencies": [
    "button",
    "dropdown-menu",
    "scroll-area",
    "input",
    "popover"
  ],
  "files": [
    {
      "path": "src/registry/editor/editor.tsx",
      "content": "\"use client\"\n\nimport { Button } from \"@/components/ui/button\"\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\"\nimport { Input } from \"@/components/ui/input\"\nimport { ScrollArea } from \"@/components/ui/scroll-area\"\nimport { cn } from \"@/lib/utils\"\nimport * as React from \"react\"\n\nimport { TextAlign } from \"@tiptap/extension-text-align\"\nimport TiptapTypography from \"@tiptap/extension-typography\"\nimport TiptapUnderline from \"@tiptap/extension-underline\"\nimport {\n  BubbleMenu,\n  Editor,\n  Extensions,\n  FloatingMenu,\n  EditorContent as TiptapEditorContent,\n  useEditorState,\n  useEditor as useTiptapEditor,\n  type UseEditorOptions,\n} from \"@tiptap/react\"\nimport StarterKit from \"@tiptap/starter-kit\"\nimport {\n  AlignCenter,\n  AlignJustify,\n  AlignLeft,\n  AlignRight,\n  Bold,\n  Check,\n  CheckSquare,\n  ChevronDown,\n  Code,\n  Heading1,\n  Heading2,\n  Heading3,\n  Heading4,\n  Heading5,\n  Heading6,\n  Highlighter,\n  ImageUp,\n  Italic,\n  Link2,\n  Link2Off,\n  List,\n  ListOrdered,\n  Minus,\n  Redo,\n  Strikethrough,\n  TextQuote,\n  Type,\n  Underline,\n  Undo,\n} from \"lucide-react\"\nimport { EditorBubbleMenuLink } from \"./editor-link\"\nimport { EDITOR_PLACEHOLDER_CLASSES } from \"./editor-placeholder\"\n\n// =============================================================================\n// Constants\n// =============================================================================\n\nexport const EDITOR_ACTIONS = {\n  // @tiptap/starter-kit\n  undo: \"undo\",\n  redo: \"redo\",\n  bold: \"bold\",\n  italic: \"italic\",\n  strike: \"strike\",\n  code: \"code\",\n  divider: \"divider\",\n  heading1: \"heading1\",\n  heading2: \"heading2\",\n  heading3: \"heading3\",\n  heading4: \"heading4\",\n  heading5: \"heading5\",\n  heading6: \"heading6\",\n  text: \"paragraph\",\n  blockquote: \"blockquote\",\n  bulletList: \"bulletList\",\n  orderedList: \"orderedList\",\n  codeBlock: \"codeBlock\",\n  // @tiptap/extension-underline\n  underline: \"underline\",\n  // Text alignment\n  left: \"left\",\n  center: \"center\",\n  right: \"right\",\n  justify: \"justify\",\n  // Image\n  image: \"image\",\n  // Table\n  insertTable: \"insertTable\",\n  addColumnBefore: \"addColumnBefore\",\n  addColumnAfter: \"addColumnAfter\",\n  deleteColumn: \"deleteColumn\",\n  addRowBefore: \"addRowBefore\",\n  addRowAfter: \"addRowAfter\",\n  deleteRow: \"deleteRow\",\n  deleteTable: \"deleteTable\",\n  mergeCells: \"mergeCells\",\n  splitCell: \"splitCell\",\n  toggleHeaderColumn: \"toggleHeaderColumn\",\n  toggleHeaderRow: \"toggleHeaderRow\",\n  toggleHeaderCell: \"toggleHeaderCell\",\n  mergeOrSplit: \"mergeOrSplit\",\n  goToNextCell: \"goToNextCell\",\n  goToPreviousCell: \"goToPreviousCell\",\n  // Task list\n  taskList: \"taskList\",\n  // Highlight\n  highlight: \"highlight\",\n  // Link\n  setLink: \"setLink\",\n  unsetLink: \"unsetLink\",\n} as const\n\nexport type EditorAction = (typeof EDITOR_ACTIONS)[keyof typeof EDITOR_ACTIONS]\n\nconst EDITOR_TEXT_ALIGN_ACTIONS: EditorAction[] = [\n  EDITOR_ACTIONS.left,\n  EDITOR_ACTIONS.center,\n  EDITOR_ACTIONS.right,\n  EDITOR_ACTIONS.justify,\n]\n\n// =============================================================================\n// Types\n// =============================================================================\n\nexport interface EditorBlock {\n  key: EditorAction\n  icon: React.ElementType\n  label: string\n  description: string\n}\n\nexport const EDITOR_BLOCKS_MAP = new Map<EditorAction, EditorBlock>([\n  [\n    EDITOR_ACTIONS.undo,\n    {\n      key: EDITOR_ACTIONS.undo,\n      icon: Undo,\n      label: \"Undo\",\n      description: \"Undo the last action\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.redo,\n    {\n      key: EDITOR_ACTIONS.redo,\n      icon: Redo,\n      label: \"Redo\",\n      description: \"Redo the last action\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.text,\n    {\n      key: EDITOR_ACTIONS.text,\n      icon: Type,\n      label: \"Text\",\n      description: \"Start writing with plain text\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.heading1,\n    {\n      key: EDITOR_ACTIONS.heading1,\n      icon: Heading1,\n      label: \"Heading 1\",\n      description: \"Use this for main titles\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.heading2,\n    {\n      key: EDITOR_ACTIONS.heading2,\n      icon: Heading2,\n      label: \"Heading 2\",\n      description: \"Ideal for subsections\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.heading3,\n    {\n      key: EDITOR_ACTIONS.heading3,\n      icon: Heading3,\n      label: \"Heading 3\",\n      description: \"Use for smaller subsections\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.heading4,\n    {\n      key: EDITOR_ACTIONS.heading4,\n      icon: Heading4,\n      label: \"Heading 4\",\n      description: \"Suitable for detailed sections\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.heading5,\n    {\n      key: EDITOR_ACTIONS.heading5,\n      icon: Heading5,\n      label: \"Heading 5\",\n      description: \"For minor details\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.heading6,\n    {\n      key: EDITOR_ACTIONS.heading6,\n      icon: Heading6,\n      label: \"Heading 6\",\n      description: \"Use for the smallest details\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.blockquote,\n    {\n      key: EDITOR_ACTIONS.blockquote,\n      icon: TextQuote,\n      label: \"Quote\",\n      description: \"Capture a quote\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.bold,\n    {\n      key: EDITOR_ACTIONS.bold,\n      icon: Bold,\n      label: \"Bold\",\n      description: \"Make text bold\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.italic,\n    {\n      key: EDITOR_ACTIONS.italic,\n      icon: Italic,\n      label: \"Italic\",\n      description: \"Italicize text\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.underline,\n    {\n      key: EDITOR_ACTIONS.underline,\n      icon: Underline,\n      label: \"Underline\",\n      description: \"Underline text\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.strike,\n    {\n      key: EDITOR_ACTIONS.strike,\n      icon: Strikethrough,\n      label: \"Strikethrough\",\n      description: \"Strike through text\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.code,\n    {\n      key: EDITOR_ACTIONS.code,\n      icon: Code,\n      label: \"Code\",\n      description: \"Format text as code\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.divider,\n    {\n      key: EDITOR_ACTIONS.divider,\n      icon: Minus,\n      label: \"Divider\",\n      description: \"Visually divide blocks\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.bulletList,\n    {\n      key: EDITOR_ACTIONS.bulletList,\n      icon: List,\n      label: \"Bullet List\",\n      description: \"Create a bullet list\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.orderedList,\n    {\n      key: EDITOR_ACTIONS.orderedList,\n      icon: ListOrdered,\n      label: \"Ordered List\",\n      description: \"Create an ordered list\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.left,\n    {\n      key: EDITOR_ACTIONS.left,\n      icon: AlignLeft,\n      label: \"Left\",\n      description: \"Align text to the left\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.center,\n    {\n      key: EDITOR_ACTIONS.center,\n      icon: AlignCenter,\n      label: \"Center\",\n      description: \"Align text to the center\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.right,\n    {\n      key: EDITOR_ACTIONS.right,\n      icon: AlignRight,\n      label: \"Right\",\n      description: \"Align text to the right\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.justify,\n    {\n      key: EDITOR_ACTIONS.justify,\n      icon: AlignJustify,\n      label: \"Justify\",\n      description: \"Align text to justify\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.image,\n    {\n      key: EDITOR_ACTIONS.image,\n      icon: ImageUp,\n      label: \"Image\",\n      description: \"Upload or embed an image\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.taskList,\n    {\n      key: EDITOR_ACTIONS.taskList,\n      icon: CheckSquare,\n      label: \"Task List\",\n      description: \"Create a task list with checkboxes\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.highlight,\n    {\n      key: EDITOR_ACTIONS.highlight,\n      icon: Highlighter,\n      label: \"Highlight\",\n      description: \"Highlight selected text\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.setLink,\n    {\n      key: EDITOR_ACTIONS.setLink,\n      icon: Link2,\n      label: \"Add Link\",\n      description: \"Insert a hyperlink\",\n    },\n  ],\n  [\n    EDITOR_ACTIONS.unsetLink,\n    {\n      key: EDITOR_ACTIONS.unsetLink,\n      icon: Link2Off,\n      label: \"Remove Link\",\n      description: \"Remove the hyperlink\",\n    },\n  ],\n])\n\n// =============================================================================\n// Default Extensions\n// =============================================================================\n\nexport const defaultExtensions = [\n  StarterKit.configure({\n    codeBlock: false, // Use CodeBlock extension separately\n  }),\n  TiptapUnderline.configure({\n    HTMLAttributes: {\n      class: \"underline underline-offset-4\",\n    },\n  }),\n  TextAlign.configure({\n    types: [\"heading\", \"paragraph\", \"blockquote\", \"bulletList\", \"orderedList\"],\n  }),\n  TiptapTypography.configure({}),\n]\n\n// =============================================================================\n// Context\n// =============================================================================\n\nexport interface EditorContextValue {\n  editor: Editor | null\n}\n\nexport const EditorContext = React.createContext<EditorContextValue | null>(\n  null\n)\n\nexport function useEditor(): EditorContextValue {\n  const ctx = React.useContext(EditorContext)\n  if (!ctx) {\n    throw new Error(\"useEditor must be used within EditorProvider\")\n  }\n  return ctx\n}\n\n// =============================================================================\n// Utility Functions\n// =============================================================================\n\nexport function canUseEditorAction(\n  editor: Editor | null,\n  action: EditorAction\n): boolean {\n  if (!editor) return false\n\n  switch (action) {\n    case EDITOR_ACTIONS.undo:\n      return editor.can().chain().focus().undo().run()\n    case EDITOR_ACTIONS.redo:\n      return editor.can().chain().focus().redo().run()\n    case EDITOR_ACTIONS.text:\n      return editor.can().chain().focus().setParagraph().run()\n    case EDITOR_ACTIONS.heading1:\n      return editor.can().chain().focus().setHeading({ level: 1 }).run()\n    case EDITOR_ACTIONS.heading2:\n      return editor.can().chain().focus().setHeading({ level: 2 }).run()\n    case EDITOR_ACTIONS.heading3:\n      return editor.can().chain().focus().setHeading({ level: 3 }).run()\n    case EDITOR_ACTIONS.heading4:\n      return editor.can().chain().focus().setHeading({ level: 4 }).run()\n    case EDITOR_ACTIONS.heading5:\n      return editor.can().chain().focus().setHeading({ level: 5 }).run()\n    case EDITOR_ACTIONS.heading6:\n      return editor.can().chain().focus().setHeading({ level: 6 }).run()\n    case EDITOR_ACTIONS.codeBlock:\n      return editor.can().chain().focus().toggleCodeBlock().run()\n    case EDITOR_ACTIONS.divider:\n      return editor.can().chain().focus().setHorizontalRule().run()\n    case EDITOR_ACTIONS.bold:\n      return editor.can().chain().focus().toggleBold().run()\n    case EDITOR_ACTIONS.italic:\n      return editor.can().chain().focus().toggleItalic().run()\n    case EDITOR_ACTIONS.strike:\n      return editor.can().chain().focus().toggleStrike().run()\n    case EDITOR_ACTIONS.code:\n      return editor.can().chain().focus().toggleCode().run()\n    case EDITOR_ACTIONS.blockquote:\n      return editor.can().chain().focus().setBlockquote().run()\n    case EDITOR_ACTIONS.bulletList:\n      return editor.can().chain().focus().toggleBulletList().run()\n    case EDITOR_ACTIONS.orderedList:\n      return editor.can().chain().focus().toggleOrderedList().run()\n    case EDITOR_ACTIONS.left:\n      return editor.can().chain().focus().setTextAlign(\"left\").run()\n    case EDITOR_ACTIONS.center:\n      return editor.can().chain().focus().setTextAlign(\"center\").run()\n    case EDITOR_ACTIONS.right:\n      return editor.can().chain().focus().setTextAlign(\"right\").run()\n    case EDITOR_ACTIONS.underline:\n      return editor.can().chain().focus().toggleUnderline().run()\n    case EDITOR_ACTIONS.image:\n      return true\n    case EDITOR_ACTIONS.insertTable:\n      return editor\n        .can()\n        .chain()\n        .focus()\n        .insertTable({ rows: 3, cols: 3 })\n        .run()\n    case EDITOR_ACTIONS.addColumnBefore:\n      return editor.can().chain().focus().addColumnBefore().run()\n    case EDITOR_ACTIONS.addColumnAfter:\n      return editor.can().chain().focus().addColumnAfter().run()\n    case EDITOR_ACTIONS.deleteColumn:\n      return editor.can().chain().focus().deleteColumn().run()\n    case EDITOR_ACTIONS.addRowBefore:\n      return editor.can().chain().focus().addRowBefore().run()\n    case EDITOR_ACTIONS.addRowAfter:\n      return editor.can().chain().focus().addRowAfter().run()\n    case EDITOR_ACTIONS.deleteRow:\n      return editor.can().chain().focus().deleteRow().run()\n    case EDITOR_ACTIONS.deleteTable:\n      return editor.can().chain().focus().deleteTable().run()\n    case EDITOR_ACTIONS.mergeCells:\n      return editor.can().chain().focus().mergeCells().run()\n    case EDITOR_ACTIONS.splitCell:\n      return editor.can().chain().focus().splitCell().run()\n    case EDITOR_ACTIONS.toggleHeaderColumn:\n      return editor.can().chain().focus().toggleHeaderColumn().run()\n    case EDITOR_ACTIONS.toggleHeaderRow:\n      return editor.can().chain().focus().toggleHeaderRow().run()\n    case EDITOR_ACTIONS.toggleHeaderCell:\n      return editor.can().chain().focus().toggleHeaderCell().run()\n    case EDITOR_ACTIONS.mergeOrSplit:\n      return editor.can().chain().focus().mergeOrSplit().run()\n    case EDITOR_ACTIONS.goToNextCell:\n      return editor.can().chain().focus().goToNextCell().run()\n    case EDITOR_ACTIONS.goToPreviousCell:\n      return editor.can().chain().focus().goToPreviousCell().run()\n    case EDITOR_ACTIONS.taskList:\n      return editor.can().chain().focus().toggleTaskList().run()\n    case EDITOR_ACTIONS.highlight:\n      return editor.can().chain().focus().toggleHighlight().run()\n    case EDITOR_ACTIONS.setLink:\n      return true\n    case EDITOR_ACTIONS.unsetLink:\n      return editor.isActive(\"link\")\n    default:\n      return true\n  }\n}\n\nexport function executeEditorAction(\n  editor: Editor | null,\n  action: EditorAction,\n  options: Record<string, unknown> = {}\n): void {\n  if (!editor) return\n\n  switch (action) {\n    case EDITOR_ACTIONS.undo:\n      editor.chain().focus().undo().run()\n      break\n    case EDITOR_ACTIONS.redo:\n      editor.chain().focus().redo().run()\n      break\n    case EDITOR_ACTIONS.text:\n      editor.chain().focus().setParagraph().run()\n      break\n    case EDITOR_ACTIONS.heading1:\n      editor.chain().focus().setHeading({ level: 1 }).run()\n      break\n    case EDITOR_ACTIONS.heading2:\n      editor.chain().focus().setHeading({ level: 2 }).run()\n      break\n    case EDITOR_ACTIONS.heading3:\n      editor.chain().focus().setHeading({ level: 3 }).run()\n      break\n    case EDITOR_ACTIONS.heading4:\n      editor.chain().focus().setHeading({ level: 4 }).run()\n      break\n    case EDITOR_ACTIONS.heading5:\n      editor.chain().focus().setHeading({ level: 5 }).run()\n      break\n    case EDITOR_ACTIONS.heading6:\n      editor.chain().focus().setHeading({ level: 6 }).run()\n      break\n    case EDITOR_ACTIONS.codeBlock:\n      editor.chain().focus().toggleCodeBlock().run()\n      break\n    case EDITOR_ACTIONS.divider:\n      editor.chain().focus().setHorizontalRule().run()\n      break\n    case EDITOR_ACTIONS.bold:\n      editor.chain().focus().toggleBold().run()\n      break\n    case EDITOR_ACTIONS.italic:\n      editor.chain().focus().toggleItalic().run()\n      break\n    case EDITOR_ACTIONS.strike:\n      editor.chain().focus().toggleStrike().run()\n      break\n    case EDITOR_ACTIONS.code:\n      editor.chain().focus().toggleCode().run()\n      break\n    case EDITOR_ACTIONS.blockquote:\n      editor.chain().focus().setBlockquote().run()\n      break\n    case EDITOR_ACTIONS.bulletList:\n      editor.chain().focus().toggleBulletList().run()\n      break\n    case EDITOR_ACTIONS.orderedList:\n      editor.chain().focus().toggleOrderedList().run()\n      break\n    case EDITOR_ACTIONS.left:\n      editor.chain().focus().setTextAlign(\"left\").run()\n      break\n    case EDITOR_ACTIONS.center:\n      editor.chain().focus().setTextAlign(\"center\").run()\n      break\n    case EDITOR_ACTIONS.right:\n      editor.chain().focus().setTextAlign(\"right\").run()\n      break\n    case EDITOR_ACTIONS.justify:\n      editor.chain().focus().setTextAlign(\"justify\").run()\n      break\n    case EDITOR_ACTIONS.underline:\n      editor.chain().focus().toggleUnderline().run()\n      break\n    case EDITOR_ACTIONS.image:\n      editor\n        .chain()\n        .focus()\n        .setImage({\n          src: options.src as string,\n          alt: options.alt as string,\n          title: options.title as string,\n        })\n        .run()\n      break\n    case EDITOR_ACTIONS.insertTable:\n      editor\n        .chain()\n        .focus()\n        .insertTable({ rows: 3, cols: 3, withHeaderRow: true })\n        .run()\n      break\n    case EDITOR_ACTIONS.addColumnBefore:\n      editor.chain().focus().addColumnBefore().run()\n      break\n    case EDITOR_ACTIONS.addColumnAfter:\n      editor.chain().focus().addColumnAfter().run()\n      break\n    case EDITOR_ACTIONS.deleteColumn:\n      editor.chain().focus().deleteColumn().run()\n      break\n    case EDITOR_ACTIONS.addRowBefore:\n      editor.chain().focus().addRowBefore().run()\n      break\n    case EDITOR_ACTIONS.addRowAfter:\n      editor.chain().focus().addRowAfter().run()\n      break\n    case EDITOR_ACTIONS.deleteRow:\n      editor.chain().focus().deleteRow().run()\n      break\n    case EDITOR_ACTIONS.deleteTable:\n      editor.chain().focus().deleteTable().run()\n      break\n    case EDITOR_ACTIONS.mergeCells:\n      editor.chain().focus().mergeCells().run()\n      break\n    case EDITOR_ACTIONS.splitCell:\n      editor.chain().focus().splitCell().run()\n      break\n    case EDITOR_ACTIONS.toggleHeaderColumn:\n      editor.chain().focus().toggleHeaderColumn().run()\n      break\n    case EDITOR_ACTIONS.toggleHeaderRow:\n      editor.chain().focus().toggleHeaderRow().run()\n      break\n    case EDITOR_ACTIONS.toggleHeaderCell:\n      editor.chain().focus().toggleHeaderCell().run()\n      break\n    case EDITOR_ACTIONS.mergeOrSplit:\n      editor.chain().focus().mergeOrSplit().run()\n      break\n    case EDITOR_ACTIONS.goToNextCell:\n      editor.chain().focus().goToNextCell().run()\n      break\n    case EDITOR_ACTIONS.goToPreviousCell:\n      editor.chain().focus().goToPreviousCell().run()\n      break\n    case EDITOR_ACTIONS.taskList:\n      editor.chain().focus().toggleTaskList().run()\n      break\n    case EDITOR_ACTIONS.highlight:\n      editor.chain().focus().toggleHighlight().run()\n      break\n    case EDITOR_ACTIONS.unsetLink:\n      editor.chain().focus().unsetLink().run()\n      break\n  }\n}\n\nexport function getActiveEditorActions(editor: Editor | null): EditorAction[] {\n  if (!editor) return [EDITOR_ACTIONS.text]\n\n  const keys: Set<EditorAction> = new Set()\n\n  if (editor.isActive(\"heading\")) {\n    const headingLevel = editor.getAttributes(\"heading\").level\n    const headingMap = `heading${headingLevel}` as EditorAction\n    if (EDITOR_BLOCKS_MAP.has(headingMap)) {\n      keys.add(headingMap)\n    }\n  }\n\n  EDITOR_BLOCKS_MAP.forEach((block) => {\n    if (EDITOR_TEXT_ALIGN_ACTIONS.includes(block.key)) {\n      if (editor.isActive({ textAlign: block.key })) {\n        keys.add(block.key)\n      }\n    } else if (editor.isActive(block.key)) {\n      keys.add(block.key)\n    }\n  })\n\n  // Paragraph (text) has lowest priority - if any other block is active, hide paragraph\n  if (keys.size > 1 && keys.has(EDITOR_ACTIONS.text)) {\n    keys.delete(EDITOR_ACTIONS.text)\n  }\n\n  return keys.size > 0 ? Array.from(keys) : [EDITOR_ACTIONS.text]\n}\n\n// =============================================================================\n// EditorProvider\n// =============================================================================\n\ntype NestedArray<T> = T | NestedArray<T>[]\n\nexport type EditorExtensions = NestedArray<Extensions[number]>\n\nexport interface EditorProviderProps\n  extends React.PropsWithChildren, Omit<UseEditorOptions, \"extensions\"> {\n  content?: string\n  extensions?: EditorExtensions[]\n  className?: string\n}\n\nconst EditorProvider = React.forwardRef<HTMLDivElement, EditorProviderProps>(\n  (\n    { content, extensions = [], children, className, ...editorOptions },\n    ref\n  ) => {\n    const editor = useTiptapEditor({\n      content,\n      extensions: toLatentArray(defaultExtensions, extensions),\n      ...editorOptions,\n    })\n\n    const contextValue = React.useMemo<EditorContextValue>(\n      () => ({ editor }),\n      [editor]\n    )\n\n    return (\n      <EditorContext.Provider value={contextValue}>\n        <div\n          ref={ref}\n          className={cn(\"relative\", className)}\n          data-editor-root=\"\"\n        >\n          {children}\n        </div>\n      </EditorContext.Provider>\n    )\n  }\n)\nEditorProvider.displayName = \"EditorProvider\"\n\n// =============================================================================\n// EditorContent\n// =============================================================================\n\nexport interface EditorContentProps extends Omit<\n  React.ComponentProps<typeof TiptapEditorContent>,\n  \"editor\"\n> {}\n\nconst EditorContent = React.forwardRef<HTMLDivElement, EditorContentProps>(\n  ({ className, ...props }, ref) => {\n    const { editor } = useEditor()\n\n    if (!editor) return null\n\n    return (\n      <TiptapEditorContent\n        ref={ref}\n        editor={editor}\n        className={cn(\n          \"w-full\",\n          \"[&>*]:outline-none\",\n          // Inline code styles\n          \"[&_.ProseMirror_code]:bg-muted\",\n          \"[&_.ProseMirror_code]:rounded\",\n          \"[&_.ProseMirror_code]:px-1.5\",\n          \"[&_.ProseMirror_code]:py-0.5\",\n          \"[&_.ProseMirror_code]:font-mono\",\n          \"[&_.ProseMirror_code]:text-[0.875em]\",\n          // Task list styles\n          \"[&_.ProseMirror_ul[data-type=taskList]]:list-none\",\n          \"[&_.ProseMirror_ul[data-type=taskList]]:pl-0\",\n          \"[&_.ProseMirror_ul[data-type=taskList]]:my-2\",\n          \"[&_.ProseMirror_ul[data-type=taskList]_li]:flex\",\n          \"[&_.ProseMirror_ul[data-type=taskList]_li]:items-start\",\n          \"[&_.ProseMirror_ul[data-type=taskList]_li]:gap-2\",\n          \"[&_.ProseMirror_ul[data-type=taskList]_li]:my-1\",\n          \"[&_.ProseMirror_ul[data-type=taskList]_li>label]:shrink-0\",\n          \"[&_.ProseMirror_ul[data-type=taskList]_li>label]:mt-0.5\",\n          \"[&_.ProseMirror_ul[data-type=taskList]_li>label>input[type=checkbox]]:cursor-pointer\",\n          \"[&_.ProseMirror_ul[data-type=taskList]_li>label>input[type=checkbox]]:size-4\",\n          \"[&_.ProseMirror_ul[data-type=taskList]_li>label>input[type=checkbox]]:accent-primary\",\n          \"[&_.ProseMirror_ul[data-type=taskList]_li>div]:flex-1\",\n          \"[&_.ProseMirror_ul[data-type=taskList]_li[data-checked=true]>div]:line-through\",\n          \"[&_.ProseMirror_ul[data-type=taskList]_li[data-checked=true]>div]:opacity-60\",\n          // Placeholder styles\n          EDITOR_PLACEHOLDER_CLASSES,\n          className\n        )}\n        {...props}\n      />\n    )\n  }\n)\nEditorContent.displayName = \"EditorContent\"\n\n// =============================================================================\n// EditorToolbar\n// =============================================================================\n\nexport interface EditorToolbarProps extends React.ComponentProps<\"div\"> {\n  orientation?: \"horizontal\" | \"vertical\"\n}\n\nconst EditorToolbar = React.forwardRef<HTMLDivElement, EditorToolbarProps>(\n  ({ className, orientation = \"horizontal\", children, ...props }, ref) => {\n    const { editor } = useEditor()\n\n    if (!editor) return null\n\n    return (\n      <div\n        ref={ref}\n        role=\"toolbar\"\n        aria-orientation={orientation}\n        className={cn(\n          \"flex items-center gap-1\",\n          orientation === \"vertical\" && \"flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n)\nEditorToolbar.displayName = \"EditorToolbar\"\n\n// =============================================================================\n// EditorButtonGroup\n// =============================================================================\n\nexport interface EditorButtonGroupProps extends React.ComponentProps<\"div\"> {}\n\nconst EditorButtonGroup = React.forwardRef<\n  HTMLDivElement,\n  EditorButtonGroupProps\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      className={cn(\"flex items-center gap-0.5\", className)}\n      {...props}\n    />\n  )\n})\nEditorButtonGroup.displayName = \"EditorButtonGroup\"\n\n// Alias\nconst EditorToolbarGroup = EditorButtonGroup\n\n// =============================================================================\n// EditorButton\n// =============================================================================\n\nexport interface EditorButtonProps extends React.ComponentProps<typeof Button> {\n  action: EditorAction\n  activeVariant?: \"default\" | \"secondary\" | \"outline\"\n}\n\nconst EditorButton = React.forwardRef<HTMLButtonElement, EditorButtonProps>(\n  (\n    { action, activeVariant = \"secondary\", className, children, ...props },\n    ref\n  ) => {\n    const { editor } = useEditor()\n\n    const isActive = React.useMemo(() => {\n      if (!editor) return false\n      if (EDITOR_TEXT_ALIGN_ACTIONS.includes(action)) {\n        return editor.isActive({ textAlign: action })\n      }\n      return editor.isActive(action)\n    }, [editor, action])\n\n    const canUse = React.useMemo(\n      () => canUseEditorAction(editor, action),\n      [editor, action]\n    )\n\n    const handleClick = () => {\n      executeEditorAction(editor, action)\n    }\n\n    const block = EDITOR_BLOCKS_MAP.get(action)\n\n    if (!editor) return null\n\n    return (\n      <Button\n        ref={ref}\n        type=\"button\"\n        variant={isActive ? activeVariant : \"ghost\"}\n        size=\"icon\"\n        disabled={!canUse}\n        onClick={handleClick}\n        aria-label={block?.label}\n        className={cn(\"size-8\", className)}\n        {...props}\n      >\n        {children}\n      </Button>\n    )\n  }\n)\nEditorButton.displayName = \"EditorButton\"\n\n// =============================================================================\n// EditorSeparator\n// =============================================================================\n\nexport interface EditorSeparatorProps extends React.ComponentProps<\"span\"> {}\n\nconst EditorSeparator = React.forwardRef<HTMLSpanElement, EditorSeparatorProps>(\n  ({ className, ...props }, ref) => {\n    const { editor } = useEditor()\n\n    if (!editor) return null\n\n    return (\n      <span\n        ref={ref}\n        className={cn(\"text-border mx-1 inline-flex items-center\", className)}\n        {...props}\n      >\n        |\n      </span>\n    )\n  }\n)\nEditorSeparator.displayName = \"EditorSeparator\"\n\n// =============================================================================\n// EditorDropdown Context\n// =============================================================================\n\ninterface EditorDropdownContextValue {\n  sharedBlocks: EditorBlock[]\n}\n\nconst EditorDropdownContext =\n  React.createContext<EditorDropdownContextValue | null>(null)\n\n// =============================================================================\n// EditorDropdown\n// =============================================================================\n\nexport interface EditorDropdownProps extends React.ComponentProps<\n  typeof DropdownMenu\n> {\n  actions: EditorAction[]\n}\n\nconst EditorDropdown = React.forwardRef<HTMLButtonElement, EditorDropdownProps>(\n  ({ actions, children, ...props }, _ref) => {\n    const { editor } = useEditor()\n\n    const handleChangeBlock = (key: EditorAction) => {\n      executeEditorAction(editor, key)\n    }\n\n    const filteredBlocks = actions\n      .map((action) => EDITOR_BLOCKS_MAP.get(action)!)\n      .filter(Boolean)\n\n    const contextValue = React.useMemo<EditorDropdownContextValue>(\n      () => ({ sharedBlocks: filteredBlocks }),\n      [filteredBlocks]\n    )\n\n    if (!editor) return null\n\n    return (\n      <EditorDropdownContext.Provider value={contextValue}>\n        <DropdownMenu {...props}>\n          <DropdownMenuTrigger asChild>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              className=\"shadow-none\"\n              aria-label=\"Open blocks menu\"\n            >\n              {children}\n              <ChevronDown className=\"text-muted-foreground ml-1 size-3\" />\n            </Button>\n          </DropdownMenuTrigger>\n          <DropdownMenuContent className=\"pb-2\">\n            <ScrollArea\n              style={{\n                height: Math.min(filteredBlocks.length * 56, 300),\n              }}\n              className=\"max-h-[300px] overflow-auto\"\n            >\n              {filteredBlocks.map((item) => (\n                <DropdownMenuItem\n                  key={item.label}\n                  onClick={() => handleChangeBlock(item.key)}\n                >\n                  <div\n                    className=\"border-border bg-background flex size-8 items-center justify-center rounded-lg border\"\n                    aria-hidden=\"true\"\n                  >\n                    <item.icon\n                      size={16}\n                      strokeWidth={2}\n                      className=\"opacity-60\"\n                    />\n                  </div>\n                  <div>\n                    <div className=\"text-sm font-medium\">{item.label}</div>\n                    <div className=\"text-muted-foreground text-xs\">\n                      {item.description}\n                    </div>\n                  </div>\n                </DropdownMenuItem>\n              ))}\n            </ScrollArea>\n          </DropdownMenuContent>\n        </DropdownMenu>\n      </EditorDropdownContext.Provider>\n    )\n  }\n)\nEditorDropdown.displayName = \"EditorDropdown\"\n\n// =============================================================================\n// EditorLabel\n// =============================================================================\n\nexport interface EditorLabelProps extends React.ComponentProps<\"span\"> {\n  action?: EditorAction\n  pattern?: \":icon :label\" | \":label\" | \":label :icon\" | \":icon\"\n}\n\nconst EditorLabel = React.forwardRef<HTMLSpanElement, EditorLabelProps>(\n  ({ className, action, pattern = \":label\", ...props }, ref) => {\n    const dropdownCtx = React.useContext(EditorDropdownContext)\n    const { editor } = useEditor()\n\n    const activeActions =\n      useEditorState({\n        editor,\n        selector: ({ editor: e }) => getActiveEditorActions(e),\n      }) ?? []\n\n    const blocks = React.useMemo(() => {\n      if (action) {\n        const block = EDITOR_BLOCKS_MAP.get(action)\n        return block ? [block] : []\n      }\n\n      const filteredActions = dropdownCtx?.sharedBlocks?.length\n        ? activeActions.filter((a) =>\n            dropdownCtx.sharedBlocks.some((b) => b.key === a)\n          )\n        : activeActions\n\n      return filteredActions\n        .map((key) => EDITOR_BLOCKS_MAP.get(key)!)\n        .filter(Boolean)\n    }, [action, activeActions, dropdownCtx])\n\n    const renderBlock = (block: EditorBlock) => {\n      switch (pattern) {\n        case \":icon :label\":\n          return (\n            <React.Fragment key={block.key}>\n              <block.icon className=\"size-4\" />\n              {block.label}\n            </React.Fragment>\n          )\n        case \":icon\":\n          return (\n            <React.Fragment key={block.key}>\n              <block.icon className=\"size-4\" />\n            </React.Fragment>\n          )\n        case \":label :icon\":\n          return (\n            <React.Fragment key={block.key}>\n              {block.label}\n              <block.icon className=\"size-4\" />\n            </React.Fragment>\n          )\n        default:\n          return block.label\n      }\n    }\n\n    const content =\n      blocks.length > 0\n        ? blocks.map(renderBlock)\n        : dropdownCtx?.sharedBlocks?.[0]\n          ? renderBlock(dropdownCtx.sharedBlocks[0])\n          : null\n\n    return (\n      <span\n        ref={ref}\n        className={cn(\"inline-flex items-center gap-2\", className)}\n        {...props}\n      >\n        {content}\n      </span>\n    )\n  }\n)\nEditorLabel.displayName = \"EditorLabel\"\n\n// =============================================================================\n// EditorFloatingMenu\n// =============================================================================\n\nexport interface EditorFloatingMenuProps extends Omit<\n  React.ComponentProps<typeof FloatingMenu>,\n  \"editor\"\n> {}\n\nfunction EditorFloatingMenu({ children, ...props }: EditorFloatingMenuProps) {\n  const { editor } = useEditor()\n\n  if (!editor) return null\n\n  return (\n    <FloatingMenu editor={editor} {...props}>\n      {children}\n    </FloatingMenu>\n  )\n}\n\n// =============================================================================\n// EditorBubbleMenuText\n// =============================================================================\n\nexport interface EditorBubbleMenuTextProps extends Omit<\n  React.ComponentProps<typeof BubbleMenu>,\n  \"editor\" | \"children\"\n> {}\n\nconst EditorBubbleMenuText = React.forwardRef<\n  HTMLDivElement,\n  EditorBubbleMenuTextProps\n>((props, ref) => {\n  const { editor } = useEditor()\n  const [linkUrl, setLinkUrl] = React.useState(\"\")\n  const [showLinkInput, setShowLinkInput] = React.useState(false)\n\n  if (!editor) return null\n\n  const handleSetLink = () => {\n    if (linkUrl) {\n      editor\n        .chain()\n        .focus()\n        .extendMarkRange(\"link\")\n        .setLink({ href: linkUrl })\n        .run()\n      setLinkUrl(\"\")\n      setShowLinkInput(false)\n    }\n  }\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\") {\n      e.preventDefault()\n      handleSetLink()\n    }\n    if (e.key === \"Escape\") {\n      setShowLinkInput(false)\n      setLinkUrl(\"\")\n    }\n  }\n\n  return (\n    <BubbleMenu\n      {...props}\n      editor={editor}\n      tippyOptions={{\n        duration: 100,\n        placement: \"top\",\n      }}\n      shouldShow={({ editor: e, from, to }) => {\n        if (from === to) return false\n        if (e.isActive(\"table\")) return false\n        if (e.isActive(\"codeBlock\")) return false\n        if (e.isActive(\"image\")) return false\n        return true\n      }}\n      className=\"w-fit\"\n    >\n      <div\n        ref={ref}\n        className=\"bg-popover flex items-center gap-0.5 rounded-md border p-0.5 shadow-md\"\n      >\n        {showLinkInput ? (\n          <div className=\"flex items-center gap-1 p-1\">\n            <Input\n              type=\"url\"\n              placeholder=\"https://...\"\n              value={linkUrl}\n              onChange={(e) => setLinkUrl(e.target.value)}\n              onKeyDown={handleKeyDown}\n              className=\"h-7 w-48 text-xs\"\n              autoFocus\n            />\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              className=\"h-7 w-7 p-0\"\n              onClick={handleSetLink}\n            >\n              <Check className=\"size-3.5\" />\n            </Button>\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              className=\"h-7 w-7 p-0\"\n              onClick={() => {\n                setShowLinkInput(false)\n                setLinkUrl(\"\")\n              }}\n            >\n              <Link2Off className=\"size-3.5\" />\n            </Button>\n          </div>\n        ) : (\n          <>\n            <Button\n              variant={editor.isActive(\"bold\") ? \"secondary\" : \"ghost\"}\n              size=\"sm\"\n              className=\"h-7 w-7 p-0\"\n              onClick={() => editor.chain().focus().toggleBold().run()}\n              title=\"Bold\"\n            >\n              <Bold className=\"size-3.5\" />\n            </Button>\n            <Button\n              variant={editor.isActive(\"italic\") ? \"secondary\" : \"ghost\"}\n              size=\"sm\"\n              className=\"h-7 w-7 p-0\"\n              onClick={() => editor.chain().focus().toggleItalic().run()}\n              title=\"Italic\"\n            >\n              <Italic className=\"size-3.5\" />\n            </Button>\n            <Button\n              variant={editor.isActive(\"underline\") ? \"secondary\" : \"ghost\"}\n              size=\"sm\"\n              className=\"h-7 w-7 p-0\"\n              onClick={() => editor.chain().focus().toggleUnderline().run()}\n              title=\"Underline\"\n            >\n              <Underline className=\"size-3.5\" />\n            </Button>\n            <Button\n              variant={editor.isActive(\"strike\") ? \"secondary\" : \"ghost\"}\n              size=\"sm\"\n              className=\"h-7 w-7 p-0\"\n              onClick={() => editor.chain().focus().toggleStrike().run()}\n              title=\"Strikethrough\"\n            >\n              <Strikethrough className=\"size-3.5\" />\n            </Button>\n            <Button\n              variant={editor.isActive(\"code\") ? \"secondary\" : \"ghost\"}\n              size=\"sm\"\n              className=\"h-7 w-7 p-0\"\n              onClick={() => editor.chain().focus().toggleCode().run()}\n              title=\"Code\"\n            >\n              <Code className=\"size-3.5\" />\n            </Button>\n\n            <div className=\"bg-border h-4 w-px\" />\n\n            <Button\n              variant={editor.isActive(\"highlight\") ? \"secondary\" : \"ghost\"}\n              size=\"sm\"\n              className=\"h-7 w-7 p-0\"\n              onClick={() => editor.chain().focus().toggleHighlight().run()}\n              title=\"Highlight\"\n            >\n              <Highlighter className=\"size-3.5\" />\n            </Button>\n\n            <div className=\"bg-border h-4 w-px\" />\n\n            {editor.isActive(\"link\") ? (\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                className=\"h-7 w-7 p-0\"\n                onClick={() => editor.chain().focus().unsetLink().run()}\n                title=\"Remove Link\"\n              >\n                <Link2Off className=\"size-3.5\" />\n              </Button>\n            ) : (\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                className=\"h-7 w-7 p-0\"\n                onClick={() => setShowLinkInput(true)}\n                title=\"Add Link\"\n              >\n                <Link2 className=\"size-3.5\" />\n              </Button>\n            )}\n          </>\n        )}\n      </div>\n    </BubbleMenu>\n  )\n})\nEditorBubbleMenuText.displayName = \"EditorBubbleMenuText\"\n\n// =============================================================================\n// Hooks\n// =============================================================================\n\nexport function useEditorIsActive(action: EditorAction): boolean {\n  const { editor } = useEditor()\n\n  return React.useMemo(() => {\n    if (!editor) return false\n    if (EDITOR_TEXT_ALIGN_ACTIONS.includes(action)) {\n      return editor.isActive({ textAlign: action })\n    }\n    return editor.isActive(action)\n  }, [editor, action])\n}\n\nexport function useEditorCurrentActions(): EditorAction[] {\n  const { editor } = useEditor()\n  return React.useMemo(() => getActiveEditorActions(editor), [editor])\n}\n\nexport function toLatentArray<T>(...inputs: NestedArray<T>[]): T[] {\n  const out: T[] = []\n\n  // Stack holds items to process. We push in reverse so we can pop and keep order.\n  const stack: NestedArray<T>[] = []\n  for (let i = inputs.length - 1; i >= 0; i--) stack.push(inputs[i])\n\n  while (stack.length) {\n    const cur = stack.pop() as NestedArray<T>\n\n    if (Array.isArray(cur)) {\n      // Push children in reverse to preserve original order.\n      for (let i = cur.length - 1; i >= 0; i--) {\n        stack.push(cur[i] as NestedArray<T>)\n      }\n    } else {\n      out.push(cur)\n    }\n  }\n\n  return out\n}\n\n// =============================================================================\n// Exports\n// =============================================================================\n\nexport {\n  EditorBubbleMenuLink,\n  EditorBubbleMenuText,\n  EditorButton,\n  EditorButtonGroup,\n  EditorContent,\n  EditorDropdown,\n  EditorFloatingMenu,\n  EditorLabel,\n  EditorProvider,\n  EditorSeparator,\n  EditorToolbar,\n  EditorToolbarGroup,\n}\n",
      "type": "registry:ui"
    }
  ],
  "type": "registry:ui"
}