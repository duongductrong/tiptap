{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "tiptap",
  "title": "Tiptap Editor",
  "description": "A fully-featured rich text editor built with Tiptap, including toolbar, bubble menu, floating menu, and image support.",
  "dependencies": [
    "@tiptap/core",
    "@tiptap/react",
    "@tiptap/starter-kit",
    "@tiptap/extension-text-align",
    "@tiptap/extension-typography",
    "@tiptap/extension-underline",
    "@tiptap/extension-code-block-lowlight",
    "lowlight",
    "lucide-react"
  ],
  "registryDependencies": [
    "button",
    "dropdown-menu",
    "scroll-area",
    "dialog",
    "input"
  ],
  "files": [
    {
      "path": "src/registry/tiptap/tiptap.tsx",
      "content": "/* eslint-disable consistent-return */\n/* eslint-disable default-case */\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n\"use client\"\n\nimport { Button } from \"@/components/ui/button\"\nimport {\n    Dialog,\n    DialogContent,\n    DialogHeader,\n    DialogTitle,\n} from \"@/components/ui/dialog\"\nimport {\n    DropdownMenu,\n    DropdownMenuContent,\n    DropdownMenuItem,\n    DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\"\nimport { Input } from \"@/components/ui/input\"\nimport { ScrollArea } from \"@/components/ui/scroll-area\"\nimport { cn } from \"@/lib/utils\"\nimport { Extension, mergeAttributes, Node } from \"@tiptap/core\"\nimport CodeBlockLowlight from \"@tiptap/extension-code-block-lowlight\"\nimport { TextAlign } from \"@tiptap/extension-text-align\"\nimport TiptapTypography from \"@tiptap/extension-typography\"\nimport TiptapUnderline from \"@tiptap/extension-underline\"\nimport {\n    BubbleMenu,\n    Editor,\n    EditorContent,\n    FloatingMenu,\n    useEditor,\n    UseEditorOptions,\n} from \"@tiptap/react\"\nimport StarterKit from \"@tiptap/starter-kit\"\nimport { all, createLowlight } from \"lowlight\"\nimport {\n    AlignCenter,\n    AlignJustify,\n    AlignLeft,\n    AlignRight,\n    Bold,\n    ChevronDown,\n    Code,\n    Code2,\n    Heading1,\n    Heading2,\n    Heading3,\n    Heading4,\n    Heading5,\n    Heading6,\n    ImageUp,\n    Italic,\n    List,\n    ListOrdered,\n    Minus,\n    Redo,\n    Strikethrough,\n    TextQuote,\n    Type,\n    Underline,\n    Undo,\n} from \"lucide-react\"\nimport React, {\n    Children,\n    cloneElement,\n    ComponentProps,\n    ComponentType,\n    createContext,\n    Fragment,\n    PropsWithChildren,\n    ReactElement,\n    useContext,\n    useEffect,\n    useMemo,\n    useState,\n} from \"react\"\n\n// =============================================================================\n// CodeBlock Extension (inlined from extensions/code-block.tsx)\n// =============================================================================\n\nconst lowlight = createLowlight(all)\n\nconst CodeBlock = Extension.create({\n    name: \"codeBlockLowlight\",\n    addExtensions() {\n        return [\n            CodeBlockLowlight.configure({ lowlight, defaultLanguage: \"plaintext\" }),\n        ]\n    },\n})\n\n// =============================================================================\n// Image Extension (inlined from extensions/image.tsx)\n// =============================================================================\n\nexport interface ImageOptions {\n    inline: boolean\n    allowBase64: boolean\n    allowLocal: boolean\n    allowNetwork: boolean\n    allowSameDomain: boolean\n    HTMLAttributes: Record<string, any>\n    validate?: (url: string) => boolean\n}\n\ndeclare module \"@tiptap/core\" {\n    interface Commands<ReturnType> {\n        image: {\n            setImage: (options: {\n                src: string\n                alt?: string\n                title?: string\n            }) => ReturnType\n        }\n    }\n}\n\nexport const ImageEvent = new Event(\"tiptap:image\")\n\nexport const Image = Node.create<ImageOptions>({\n    name: \"image\",\n\n    addOptions() {\n        return {\n            inline: false,\n            allowBase64: true,\n            allowLocal: true,\n            allowNetwork: true,\n            allowSameDomain: true,\n            HTMLAttributes: {\n                class: \"rounded-lg border object-contain\",\n            },\n            validate(url: string) {\n                if (!this.allowBase64 && url.startsWith(\"data:\")) return false\n                if (!this.allowLocal && url.startsWith(\"file:\")) return false\n                if (!this.allowNetwork && !url.startsWith(\"http\")) return false\n                if (!this.allowSameDomain && url.startsWith(\"http\")) return false\n                return true\n            },\n        }\n    },\n\n    inline() {\n        return this.options.inline\n    },\n\n    group() {\n        return this.options.inline ? \"inline\" : \"block\"\n    },\n\n    draggable: true,\n\n    addAttributes() {\n        return {\n            src: {\n                default: null,\n                parseHTML: (el) => (el as HTMLImageElement).getAttribute(\"src\"),\n                renderHTML: (attrs) => ({ src: attrs.src }),\n            },\n            alt: {\n                default: null,\n                parseHTML: (el) => (el as HTMLImageElement).getAttribute(\"alt\"),\n                renderHTML: (attrs) => ({ alt: attrs.alt }),\n            },\n            title: {\n                default: null,\n                parseHTML: (el) => (el as HTMLImageElement).getAttribute(\"title\"),\n                renderHTML: (attrs) => ({ title: attrs.title }),\n            },\n        }\n    },\n\n    parseHTML() {\n        return [\n            {\n                tag: \"img[src]\",\n                getAttrs: (el) => {\n                    const url = (el as HTMLImageElement).getAttribute(\"src\") || \"\"\n                    if (!this.options?.validate?.(url)) return false\n                    return null\n                },\n            },\n        ]\n    },\n\n    renderHTML({ HTMLAttributes }) {\n        return [\"img\", mergeAttributes(this.options.HTMLAttributes, HTMLAttributes)]\n    },\n\n    addCommands() {\n        return {\n            setImage:\n                (options) =>\n                    ({ commands }) => {\n                        return commands.insertContent({\n                            type: this.name,\n                            attrs: options,\n                        })\n                    },\n        }\n    },\n})\n\n// =============================================================================\n// ImageWidget (inlined from widgets/image.tsx)\n// =============================================================================\n\nexport interface ImageWidgetAsset {\n    id: string\n    src: string\n    alt: string\n    title: string\n    type: string\n    size: string\n}\n\nconst extensions = [\n    /**\n     * >Nodes\n     * Blockquote, BulletList, CodeBlock, Document, HardBreak, Heading,\n     * HorizontalRule, ListItem, OrderedList, Paragraph, Text\n     *\n     * >Marks\n     * Bold, Code, Italic, Strike\n     *\n     * >Extensions\n     * Dropcursor, Gapcursor, History\n     * @reference https://tiptap.dev/api/extensions/starter-kit\n     */\n    StarterKit,\n\n    /**\n     * @reference https://tiptap.dev/docs/editor/extensions/marks/underline\n     */\n    TiptapUnderline.configure({\n        HTMLAttributes: {\n            class: \"underline underline-offset-4\",\n        },\n    }),\n\n    /**\n     * @reference https://tiptap.dev/api/extensions/text-align\n     */\n    TextAlign.configure({\n        types: [\"heading\", \"paragraph\", \"blockquote\", \"bulletList\", \"orderedList\"],\n        defaultAlignment: \"left\",\n    }),\n\n    /**\n     * @reference https://tiptap.dev/api/extensions/typography\n     */\n    TiptapTypography.configure({}),\n\n    /**\n     * @description Allow to format text as code block with syntax highlighting, lowlight\n     * @reference @/registry/tiptap/extensions/code-block.tsx\n     */\n    CodeBlock.configure({}),\n\n    /**\n     * @description Allow to insert images from the internet\n     * @reference @/registry/tiptap/extensions/image.tsx\n     */\n    Image.configure({\n        inline: false,\n        allowBase64: true,\n        allowLocal: true,\n        allowNetwork: true,\n        allowSameDomain: true,\n    }),\n]\n\nconst tiptapActions = {\n    // @tiptap/starter-kit\n    undo: \"undo\",\n    redo: \"redo\",\n    bold: \"bold\",\n    italic: \"italic\",\n    strike: \"strike\",\n    code: \"code\",\n    divider: \"divider\",\n    heading1: \"heading1\",\n    heading2: \"heading2\",\n    heading3: \"heading3\",\n    heading4: \"heading4\",\n    heading5: \"heading5\",\n    heading6: \"heading6\",\n    text: \"paragraph\",\n    blockquote: \"blockquote\",\n    bulletList: \"bulletList\",\n    orderedList: \"orderedList\",\n    codeBlock: \"codeBlock\",\n    // @tiptap/extension-underline\n    underline: \"underline\",\n    // @/registry/tiptap/extensions/text-align.tsx\n    left: \"left\",\n    center: \"center\",\n    right: \"right\",\n    justify: \"justify\",\n    // @/registry/tiptap/extensions/image.tsx\n    image: \"image\",\n} as const\n\nconst tiptapTextAlignActiveActions = [\n    tiptapActions.left,\n    tiptapActions.center,\n    tiptapActions.right,\n    tiptapActions.justify,\n] as TiptapAction[]\n\ntype TiptapAction = (typeof tiptapActions)[keyof typeof tiptapActions]\n\ntype TiptapBlock = {\n    key: TiptapAction\n    icon: React.ElementType\n    label: string\n    description: string\n\n    /**\n     * @description Optional component to render when the action is selected\n     * @example const ImageWidget = () => JSX.Element\n     */\n    widget?: ComponentType<any>\n\n    /**\n     * @description Optional event to dispatch when the action is selected\n     * @example const ImageEvent = new Event(\"tiptap:image\")\n     */\n    event?: Event\n}\n\nconst tiptapBlocksMap = new Map<TiptapAction, TiptapBlock>([\n    [\n        tiptapActions.undo,\n        {\n            key: tiptapActions.undo,\n            icon: Undo,\n            label: \"Undo\",\n            description: \"Undo the last action\",\n        },\n    ],\n    [\n        tiptapActions.redo,\n        {\n            key: tiptapActions.redo,\n            icon: Redo,\n            label: \"Redo\",\n            description: \"Redo the last action\",\n        },\n    ],\n    [\n        tiptapActions.text,\n        {\n            key: tiptapActions.text,\n            icon: Type,\n            label: \"Text\",\n            description: \"Start writing with plain text\",\n        },\n    ],\n    [\n        tiptapActions.heading1,\n        {\n            key: tiptapActions.heading1,\n            icon: Heading1,\n            label: \"Heading 1\",\n            description: \"Use this for main titles\",\n        },\n    ],\n    [\n        tiptapActions.heading2,\n        {\n            key: tiptapActions.heading2,\n            icon: Heading2,\n            label: \"Heading 2\",\n            description: \"Ideal for subsections\",\n        },\n    ],\n    [\n        tiptapActions.heading3,\n        {\n            key: tiptapActions.heading3,\n            icon: Heading3,\n            label: \"Heading 3\",\n            description: \"Use for smaller subsections\",\n        },\n    ],\n    [\n        tiptapActions.heading4,\n        {\n            key: tiptapActions.heading4,\n            icon: Heading4,\n            label: \"Heading 4\",\n            description: \"Suitable for detailed sections\",\n        },\n    ],\n    [\n        tiptapActions.heading5,\n        {\n            key: tiptapActions.heading5,\n            icon: Heading5,\n            label: \"Heading 5\",\n            description: \"For minor details\",\n        },\n    ],\n    [\n        tiptapActions.heading6,\n        {\n            key: tiptapActions.heading6,\n            icon: Heading6,\n            label: \"Heading 6\",\n            description: \"Use for the smallest details\",\n        },\n    ],\n    [\n        tiptapActions.blockquote,\n        {\n            key: tiptapActions.blockquote,\n            icon: TextQuote,\n            label: \"Quote\",\n            description: \"Capture a quote\",\n        },\n    ],\n    [\n        tiptapActions.bold,\n        {\n            key: tiptapActions.bold,\n            icon: Bold,\n            label: \"Bold\",\n            description: \"Make text bold\",\n        },\n    ],\n    [\n        tiptapActions.italic,\n        {\n            key: tiptapActions.italic,\n            icon: Italic,\n            label: \"Italic\",\n            description: \"Italicize text\",\n        },\n    ],\n    [\n        tiptapActions.underline,\n        {\n            key: tiptapActions.underline,\n            icon: Underline,\n            label: \"Underline\",\n            description: \"Underline text\",\n        },\n    ],\n    [\n        tiptapActions.strike,\n        {\n            key: tiptapActions.strike,\n            icon: Strikethrough,\n            label: \"Strikethrough\",\n            description: \"Strike through text\",\n        },\n    ],\n    [\n        tiptapActions.code,\n        {\n            key: tiptapActions.code,\n            icon: Code,\n            label: \"Code\",\n            description: \"Format text as code\",\n        },\n    ],\n    [\n        tiptapActions.codeBlock,\n        {\n            key: tiptapActions.codeBlock,\n            icon: Code2,\n            label: \"Code Block\",\n            description: \"Format text as code block\",\n        },\n    ],\n    [\n        tiptapActions.divider,\n        {\n            key: tiptapActions.divider,\n            icon: Minus,\n            label: \"Divider\",\n            description: \"Visually divide blocks\",\n        },\n    ],\n    [\n        tiptapActions.bulletList,\n        {\n            key: tiptapActions.bulletList,\n            icon: List,\n            label: \"Bullet List\",\n            description: \"Create a bullet list\",\n        },\n    ],\n    [\n        tiptapActions.orderedList,\n        {\n            key: tiptapActions.orderedList,\n            icon: ListOrdered,\n            label: \"Ordered List\",\n            description: \"Create an ordered list\",\n        },\n    ],\n    [\n        tiptapActions.left,\n        {\n            key: tiptapActions.left,\n            icon: AlignLeft,\n            label: \"Left\",\n            description: \"Align text to the left\",\n        },\n    ],\n    [\n        tiptapActions.center,\n        {\n            key: tiptapActions.center,\n            icon: AlignCenter,\n            label: \"Center\",\n            description: \"Align text to the center\",\n        },\n    ],\n    [\n        tiptapActions.right,\n        {\n            key: tiptapActions.right,\n            icon: AlignRight,\n            label: \"Right\",\n            description: \"Align text to the right\",\n        },\n    ],\n    [\n        tiptapActions.justify,\n        {\n            key: tiptapActions.justify,\n            icon: AlignJustify,\n            label: \"Justify\",\n            description: \"Align text to the justify\",\n        },\n    ],\n    [\n        tiptapActions.image,\n        {\n            key: tiptapActions.image,\n            icon: ImageUp,\n            label: \"Image\",\n            description: \"Insert an image\",\n            event: ImageEvent,\n            widget: ImageWidget,\n        },\n    ],\n])\n\nconst tiptapAllBlocks = Array.from(tiptapBlocksMap.values())\n\nexport interface TipTapContextType {\n    editor: Editor\n}\n\nexport const TipTapContext = createContext<TipTapContextType>(\n    {} as TipTapContextType\n)\n\nexport const useTiptapEditor = () => {\n    const ctx = useContext(TipTapContext)\n\n    if (!ctx)\n        throw new Error(\"useTiptapEditor must be used within a TiptapEditor\")\n\n    return ctx\n}\n\n// =============================================================================\n// ImageWidget (inlined from widgets/image.tsx)\n// =============================================================================\n\nfunction ImageWidget() {\n    const { editor } = useTiptapEditor()\n    const assets: ImageWidgetAsset[] = [\n        {\n            id: \"1\",\n            src: \"https://images.unsplash.com/photo-1740165886179-c2be3d6447ca\",\n            alt: \"Sunset at the beach\",\n            title: \"Sunset at the beach\",\n            type: \"image/jpeg\",\n            size: \"1024x768\",\n        },\n        {\n            id: \"2\",\n            src: \"https://images.unsplash.com/photo-1682687982501-1e58ab814714\",\n            alt: \"Mountain landscape\",\n            title: \"Mountain landscape\",\n            type: \"image/jpeg\",\n            size: \"1920x1080\",\n        },\n        {\n            id: \"3\",\n            src: \"https://images.unsplash.com/photo-1682687218147-9806132dc697\",\n            alt: \"City skyline\",\n            title: \"City skyline\",\n            type: \"image/jpeg\",\n            size: \"2048x1365\",\n        },\n        {\n            id: \"4\",\n            src: \"https://images.unsplash.com/photo-1682687982501-1e58ab814714\",\n            alt: \"Forest path\",\n            title: \"Forest path\",\n            type: \"image/jpeg\",\n            size: \"2048x1365\",\n        },\n        {\n            id: \"5\",\n            src: \"https://images.unsplash.com/photo-1682687218147-9806132dc697\",\n            alt: \"Desert landscape\",\n            title: \"Desert landscape\",\n            type: \"image/jpeg\",\n            size: \"2048x1365\",\n        },\n        {\n            id: \"6\",\n            src: \"https://images.unsplash.com/photo-1682695796497-31a44224d6d6\",\n            alt: \"Ocean waves\",\n            title: \"Ocean waves\",\n            type: \"image/jpeg\",\n            size: \"2048x1365\",\n        },\n        {\n            id: \"7\",\n            src: \"https://images.unsplash.com/photo-1682695797221-8164ff1fafc9\",\n            alt: \"Snow capped peaks\",\n            title: \"Snow capped peaks\",\n            type: \"image/jpeg\",\n            size: \"2048x1365\",\n        },\n        {\n            id: \"8\",\n            src: \"https://images.unsplash.com/photo-1682686581551-867e0b208bd1\",\n            alt: \"Autumn forest\",\n            title: \"Autumn forest\",\n            type: \"image/jpeg\",\n            size: \"2048x1365\",\n        },\n    ]\n\n    const [open, setOpen] = useState(false)\n\n    const handleSelect = (asset: ImageWidgetAsset) => {\n        editor.chain().focus().setImage({ src: asset.src, alt: asset.alt }).run()\n\n        setOpen(false)\n    }\n\n    useEffect(() => {\n        const handler = () => {\n            setOpen((prev) => !prev)\n        }\n\n        document.addEventListener(\"tiptap:image\", handler)\n\n        return () => {\n            document.removeEventListener(\"tiptap:image\", handler)\n        }\n    }, [open])\n\n    return (\n        <Dialog open={open} onOpenChange={setOpen}>\n            <DialogContent className=\"max-w-screen-lg\">\n                <DialogHeader className=\"mb-4\">\n                    <DialogTitle>Media Library</DialogTitle>\n                </DialogHeader>\n\n                <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center gap-2\">\n                        <Input type=\"search\" placeholder=\"Search\" className=\"w-full\" />\n                    </div>\n                    <div className=\"flex items-center justify-end gap-2\">\n                        <Button variant=\"outline\" size=\"sm\">\n                            Add new folder\n                        </Button>\n\n                        <Button variant=\"default\" size=\"sm\">\n                            Add new assets\n                        </Button>\n                    </div>\n                </div>\n\n                <div className=\"grid grid-cols-4 gap-4\">\n                    {assets.map((asset) => (\n                        <div\n                            key={asset.id}\n                            className=\"flex flex-col bg-muted rounded-md overflow-hidden\"\n                        >\n                            <img\n                                src={asset.src}\n                                alt={asset.alt}\n                                className=\"rounded-lg border w-full h-[175px] object-cover leading-none\"\n                            />\n                            <div className=\"p-3\">\n                                <p className=\"text-sm font-medium\">{asset.title}</p>\n                                <p className=\"text-xs text-muted-foreground\">\n                                    {asset.type} - {asset.size}\n                                </p>\n                                <div className=\"flex items-center gap-2 justify-end\">\n                                    <Button size=\"sm\" onClick={() => handleSelect(asset)}>\n                                        Select\n                                    </Button>\n                                </div>\n                            </div>\n                        </div>\n                    ))}\n                </div>\n            </DialogContent>\n        </Dialog>\n    )\n}\n\nexport interface TiptapEditorProps extends PropsWithChildren, UseEditorOptions {\n    content: string\n    floatingMenu?: React.ReactNode\n    bubbleMenu?: React.ReactNode\n}\n\nexport const TiptapEditor = ({\n    content,\n    floatingMenu,\n    bubbleMenu,\n    children,\n    ...editorProps\n}: TiptapEditorProps) => {\n    const editor = useEditor({\n        content,\n        extensions,\n        ...editorProps,\n    })\n\n    const sharedValues = useMemo<TipTapContextType>(\n        () => ({ editor: editor! }),\n        [editor?.state]\n    )\n\n    return (\n        <TipTapContext.Provider value={sharedValues}>\n            {children}\n\n            {floatingMenu}\n            {bubbleMenu}\n        </TipTapContext.Provider>\n    )\n}\n\nexport interface TiptapLabelProps extends ComponentProps<\"div\"> {\n    action?: TiptapAction\n    label: \":icon :label\" | \":label\" | \":label :icon\" | \":icon\"\n}\n\nexport const TiptapLabel = ({\n    className,\n    action,\n    label: labelPattern = \":label\",\n    ...props\n}: TiptapLabelProps) => {\n    const ctx = useContext(TipTapDropdownContext)\n\n    const keyLabels = useTiptapEditorCurrentActionKeys()\n\n    const tiptapBlocks = useMemo(() => {\n        const filteredKeyLabels = ctx?.sharedBlocks?.length\n            ? keyLabels.filter((k) => ctx?.sharedBlocks.find((b) => b.key === k))\n            : keyLabels\n\n        return filteredKeyLabels.map((key) => tiptapBlocksMap.get(key)!)\n    }, [keyLabels, ctx])\n\n    const getLabelNode = (block: TiptapBlock) => {\n        if (labelPattern === \":icon :label\") {\n            return (\n                <Fragment key={block.key}>\n                    {block?.icon ? <block.icon className=\"size-4\" /> : null}{\" \"}\n                    {block?.label}\n                </Fragment>\n            )\n        }\n\n        if (labelPattern === \":icon\") {\n            return (\n                <Fragment key={block.key}>\n                    {block?.icon ? <block.icon className=\"size-4\" /> : null}\n                </Fragment>\n            )\n        }\n\n        if (labelPattern === \":label :icon\") {\n            return (\n                <Fragment key={block.key}>\n                    {block?.label}{\" \"}\n                    {block?.icon ? <block.icon className=\"size-4\" /> : null}\n                </Fragment>\n            )\n        }\n\n        return block?.label\n    }\n\n    const label = useMemo(() => {\n        if (action) {\n            const block = tiptapBlocksMap.get(action)\n\n            if (!block) return null\n\n            return getLabelNode(block)\n        }\n\n        return tiptapBlocks.map(getLabelNode)\n    }, [action, tiptapBlocks])\n\n    if (tiptapBlocks.length) {\n        // console.log(\"tiptapBlocksMap.get(action!)!\", tiptapBlocks)\n    }\n\n    return (\n        <span\n            {...props}\n            className={cn(\"inline-flex items-center gap-2\", className)}\n        >\n            {Children.count(label) !== 0 ? label : getLabelNode(ctx?.sharedBlocks[0])}\n        </span>\n    )\n}\n\nexport interface TiptapButtonProps extends ComponentProps<typeof Button> {\n    action: TiptapAction\n}\n\nexport const TiptapButton = ({\n    action,\n    children,\n    className,\n    ...props\n}: TiptapButtonProps) => {\n    const { editor } = useTiptapEditor()\n\n    const isActive = useTiptapEditorIsActive(action)\n\n    const handleOnClick = () => {\n        const dispatchEventHandler = () => {\n            const customEvt = tiptapBlocksMap.get(action)?.event\n            if (customEvt) {\n                document.dispatchEvent(customEvt)\n            }\n        }\n\n        switch (action) {\n            case tiptapActions.image:\n                dispatchEventHandler()\n                break\n            default:\n                onTiptapEventChangeBlock(editor, action)\n        }\n    }\n\n    const block = useMemo(() => tiptapBlocksMap.get(action), [action])\n\n    if (!editor) return null\n\n    return (\n        <>\n            <Button\n                variant={isActive ? \"secondary\" : \"ghost\"}\n                size=\"icon\"\n                type=\"button\"\n                {...props}\n                className={cn(\"size-8 w-auto min-w-8 px-2\", className)}\n                onClick={handleOnClick}\n                aria-label={block?.label}\n                disabled={!canUseAction(editor, action)}\n            >\n                {cloneElement(children as ReactElement, { action } as any)}\n            </Button>\n            {block?.widget ? <block.widget /> : null}\n        </>\n    )\n}\n\nexport const TiptapDivider = (props: ComponentProps<\"span\">) => {\n    const { editor } = useTiptapEditor()\n\n    if (!editor) return null\n\n    return (\n        <span {...props} className=\"inline-flex items-center gap-2 text-border\">\n            |\n        </span>\n    )\n}\n\nexport interface TipTapDropdownContextType {\n    sharedBlocks: TiptapBlock[]\n}\n\nexport const TipTapDropdownContext = createContext<TipTapDropdownContextType>({\n    sharedBlocks: [],\n} as TipTapDropdownContextType)\n\nexport interface TiptapDropdownProps\n    extends ComponentProps<typeof DropdownMenu> {\n    actions: TiptapAction[]\n}\n\nexport const TiptapDropdown = ({\n    actions = tiptapAllBlocks.map((block) => block.key),\n    children,\n    ...props\n}: TiptapDropdownProps) => {\n    const { editor } = useTiptapEditor()\n\n    const handleChangeBlock = (key: TiptapAction) => {\n        onTiptapEventChangeBlock(editor, key)\n    }\n\n    const filteredBlocks = actions.map((action) => tiptapBlocksMap.get(action)!)\n\n    const sharedValues = useMemo<TipTapDropdownContextType>(\n        () => ({ sharedBlocks: filteredBlocks }),\n        [filteredBlocks]\n    )\n\n    if (!editor) return null\n\n    return (\n        <TipTapDropdownContext.Provider value={sharedValues}>\n            <DropdownMenu {...props}>\n                <DropdownMenuTrigger asChild>\n                    <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        className=\"shadow-none\"\n                        aria-label=\"Open blocks menu\"\n                    >\n                        {children}\n\n                        <ChevronDown className=\"size-3 text-muted-foreground ml-1\" />\n                    </Button>\n                </DropdownMenuTrigger>\n                <DropdownMenuContent className=\"pb-2\">\n                    <ScrollArea className=\"max-h-[300px] overflow-auto\">\n                        {filteredBlocks.map((item) => (\n                            <DropdownMenuItem\n                                key={item.label}\n                                onClick={() => handleChangeBlock(item.key)}\n                            >\n                                <div\n                                    className=\"flex size-8 items-center justify-center rounded-lg border border-border bg-background\"\n                                    aria-hidden=\"true\"\n                                >\n                                    <item.icon size={16} strokeWidth={2} className=\"opacity-60\" />\n                                </div>\n                                <div>\n                                    <div className=\"text-sm font-medium\">{item.label}</div>\n                                    <div className=\"text-xs text-muted-foreground\">\n                                        {item.description}\n                                    </div>\n                                </div>\n                            </DropdownMenuItem>\n                        ))}\n                    </ScrollArea>\n                </DropdownMenuContent>\n            </DropdownMenu>\n        </TipTapDropdownContext.Provider>\n    )\n}\n\nexport interface TiptapToolbarProps extends ComponentProps<\"div\"> { }\n\nexport const TiptapToolbar = ({ className, ...props }: TiptapToolbarProps) => (\n    <div\n        {...props}\n        className={cn(\"flex flex-row items-center gap-2\", className)}\n    />\n)\n\nexport interface TiptapContentProps\n    extends Omit<ComponentProps<typeof EditorContent>, \"editor\"> { }\n\nexport const TiptapContent = ({ className, ...props }: TiptapContentProps) => {\n    const { editor } = useContext(TipTapContext)\n\n    if (!editor) return null\n\n    return (\n        <EditorContent\n            {...props}\n            className={cn(\"w-full [&>*]:outline-none\", className)}\n            editor={editor}\n        />\n    )\n}\nexport interface TipTapFloatingMenuProps\n    extends Omit<ComponentProps<typeof FloatingMenu>, \"editor\"> { }\n\nexport const TipTapFloatingMenu = (props: TipTapFloatingMenuProps) => {\n    const { editor } = useContext(TipTapContext)\n\n    return (\n        <FloatingMenu {...props} editor={editor}>\n            {/* <ScrollArea className=\"pb-2 max-h-[400px] overflow-auto bg-background border border-border rounded-md\">\n        {tiptapAllBlocks.map((item, index) => (\n          <div\n            className=\"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0\"\n            key={`${item.key}-${index}`}\n          >\n            <div\n              className=\"flex size-8 items-center justify-center rounded-lg border border-border bg-background\"\n              aria-hidden=\"true\"\n            >\n              <item.icon size={16} strokeWidth={2} className=\"opacity-60\" />\n            </div>\n            <div>\n              <div className=\"text-sm font-medium\">{item.label}</div>\n              <div className=\"text-xs text-muted-foreground\">\n                {item.description}\n              </div>\n            </div>\n          </div>\n        ))}\n      </ScrollArea> */}\n        </FloatingMenu>\n    )\n}\n\nexport interface TipTapBubbleMenuProps\n    extends Omit<ComponentProps<typeof BubbleMenu>, \"editor\"> { }\n\nexport const TipTapBubbleMenu = (props: TipTapBubbleMenuProps) => {\n    const { editor } = useContext(TipTapContext)\n\n    if (!editor) return null\n\n    return (\n        <BubbleMenu {...props} editor={editor}>\n            This is the bubble menu\n        </BubbleMenu>\n    )\n}\n\nexport function useTiptapEditorCurrentActionKeys() {\n    const { editor } = useTiptapEditor()\n    const selectionKeys = getCurrentTiptapAction(editor)\n\n    return selectionKeys.length ? selectionKeys : [tiptapActions.text]\n}\n\nexport function useTiptapEditorIsActive(key: TiptapAction) {\n    const { editor } = useTiptapEditor()\n    return !editor\n        ? false\n        : tiptapTextAlignActiveActions.includes(key)\n            ? editor?.isActive({ textAlign: key })\n            : editor?.isActive(key)\n}\n\nexport function onTiptapEventChangeBlock(\n    editor: Editor,\n    key: TiptapAction,\n    options: Record<string, any> = {}\n) {\n    switch (key) {\n        case tiptapActions.undo:\n            editor.chain().focus().undo().run()\n            break\n        case tiptapActions.redo:\n            editor.chain().focus().redo().run()\n            break\n        case tiptapActions.text:\n            editor.chain().focus().setParagraph().run()\n            break\n        case tiptapActions.heading1:\n            editor.chain().focus().setHeading({ level: 1 }).run()\n            break\n        case tiptapActions.heading2:\n            editor.chain().focus().setHeading({ level: 2 }).run()\n            break\n        case tiptapActions.heading3:\n            editor.chain().focus().setHeading({ level: 3 }).run()\n            break\n        case tiptapActions.heading4:\n            editor.chain().focus().setHeading({ level: 4 }).run()\n            break\n        case tiptapActions.heading5:\n            editor.chain().focus().setHeading({ level: 5 }).run()\n            break\n        case tiptapActions.heading6:\n            editor.chain().focus().setHeading({ level: 6 }).run()\n            break\n        case tiptapActions.codeBlock:\n            editor.chain().focus().toggleCodeBlock().run()\n            break\n        case tiptapActions.divider:\n            editor.chain().focus().setHorizontalRule().run()\n            break\n        case tiptapActions.bold:\n            editor.chain().focus().toggleBold().run()\n            break\n        case tiptapActions.italic:\n            editor.chain().focus().toggleItalic().run()\n            break\n        case tiptapActions.strike:\n            editor.chain().focus().toggleStrike().run()\n            break\n        case tiptapActions.code:\n            editor.chain().focus().toggleCode().run()\n            break\n        case tiptapActions.blockquote:\n            editor.chain().focus().setBlockquote().run()\n            break\n        case tiptapActions.bulletList:\n            editor.chain().focus().toggleBulletList().run()\n            break\n        case tiptapActions.orderedList:\n            editor.chain().focus().toggleOrderedList().run()\n            break\n        case tiptapActions.left:\n            editor.chain().focus().setTextAlign(\"left\").run()\n            break\n        case tiptapActions.center:\n            editor.chain().focus().setTextAlign(\"center\").run()\n            break\n        case tiptapActions.right:\n            editor.chain().focus().setTextAlign(\"right\").run()\n            break\n        case tiptapActions.underline:\n            editor.chain().focus().toggleUnderline().run()\n            break\n        case tiptapActions.image:\n            editor\n                .chain()\n                .focus()\n                .setImage({\n                    src: options.src,\n                    alt: options?.alt,\n                    title: options?.title,\n                })\n                .run()\n            break\n    }\n}\n\nexport function canUseAction(editor: Editor, action: TiptapAction) {\n    switch (action) {\n        // Required @tiptap/starter-kit\n        case tiptapActions.undo:\n            return editor.can().chain().focus().undo().run()\n        case tiptapActions.redo:\n            return editor.can().chain().focus().redo().run()\n        case tiptapActions.text:\n            return editor.can().chain().focus().setParagraph().run()\n        case tiptapActions.heading1:\n            return editor.can().chain().focus().setHeading({ level: 1 }).run()\n        case tiptapActions.heading2:\n            return editor.can().chain().focus().setHeading({ level: 2 }).run()\n        case tiptapActions.heading3:\n            return editor.can().chain().focus().setHeading({ level: 3 }).run()\n        case tiptapActions.heading4:\n            return editor.can().chain().focus().setHeading({ level: 4 }).run()\n        case tiptapActions.heading5:\n            return editor.can().chain().focus().setHeading({ level: 5 }).run()\n        case tiptapActions.heading6:\n            return editor.can().chain().focus().setHeading({ level: 6 }).run()\n        case tiptapActions.codeBlock:\n            return editor.can().chain().focus().toggleCodeBlock().run()\n        case tiptapActions.divider:\n            return editor.can().chain().focus().setHorizontalRule().run()\n        case tiptapActions.bold:\n            return editor.can().chain().focus().toggleBold().run()\n        case tiptapActions.italic:\n            return editor.can().chain().focus().toggleItalic().run()\n        case tiptapActions.strike:\n            return editor.can().chain().focus().toggleStrike().run()\n        case tiptapActions.code:\n            return editor.can().chain().focus().toggleCode().run()\n        case tiptapActions.blockquote:\n            return editor.can().chain().focus().setBlockquote().run()\n        case tiptapActions.bulletList:\n            return editor.can().chain().focus().toggleBulletList().run()\n        case tiptapActions.orderedList:\n            return editor.can().chain().focus().toggleOrderedList().run()\n        // Required @tiptap/extension-text-align\n        case tiptapActions.left:\n            return editor.can().chain().focus().setTextAlign(\"left\").run()\n        case tiptapActions.center:\n            return editor.can().chain().focus().setTextAlign(\"center\").run()\n        case tiptapActions.right:\n            return editor.can().chain().focus().setTextAlign(\"right\").run()\n        // Required @tiptap/extension-underline\n        case tiptapActions.underline:\n            return editor.can().chain().focus().toggleUnderline().run()\n        case tiptapActions.image:\n            return true\n    }\n}\n\nexport function getCurrentTiptapAction(editor: Editor): TiptapAction[] {\n    const keys: Set<TiptapAction> = new Set([tiptapActions.text])\n\n    keys.clear()\n\n    if (editor.isActive(\"heading\")) {\n        const headingLevel = editor.getAttributes(\"heading\").level\n        const headingMap = `heading${headingLevel}`\n        keys.add((tiptapActions as any)[headingMap])\n    }\n\n    tiptapAllBlocks.forEach((block) => {\n        if (tiptapTextAlignActiveActions.includes(block.key)) {\n            if (editor.isActive({ textAlign: block.key })) {\n                keys.add(block.key)\n            }\n        }\n\n        if (editor.isActive(block.key)) {\n            keys.add(block.key)\n        }\n    })\n\n    return Array.from(keys)\n}\n",
      "type": "registry:ui"
    }
  ],
  "type": "registry:block"
}